{"version":3,"sources":["../../js/map.js"],"names":["$selectExclude","$selectPokemonNotify","$selectRarityNotify","$selectStyle","$selectIconResolution","$selectIconSize","$selectLuredPokestopsOnly","$selectSearchIconMarker","language","document","documentElement","lang","idToPokemon","i8lnDictionary","languageLookups","languageLookupThreshold","searchMarkerStyles","excludedPokemon","notifiedPokemon","notifiedRarity","map","rawDataIsLoading","locationMarker","rangeMarkers","searchMarker","storeZoom","noLabelsStyle","featureType","elementType","stylers","visibility","light2Style","darkStyle","pGoStyle","light2StyleNoLabels","darkStyleNoLabels","pGoStyleNoLabels","selectedStyle","mapData","pokemons","gyms","pokestops","lurePokemons","scanned","spawnpoints","gymTypes","audio","Audio","pokemonSprites","normal","columns","iconWidth","iconHeight","spriteWidth","spriteHeight","filename","name","highres","shuffle","StoreTypes","Boolean","parse","str","toLowerCase","stringify","b","JSON","json","String","Number","parseInt","number","toString","StoreOptions","default","type","isTouchDevice","Store","getOption","key","option","Error","get","optionType","rawValue","localStorage","undefined","value","set","reset","removeItem","excludePokemon","id","val","concat","trigger","notifyAboutPokemon","removePokemonMarker","encounterId","marker","rangeCircle","setMap","hidden","initMap","google","maps","Map","getElementById","center","lat","centerLat","lng","centerLng","zoom","fullscreenControl","streetViewControl","mapTypeControl","mapTypeControlOptions","style","MapTypeControlStyle","DROPDOWN_MENU","position","ControlPosition","RIGHT_TOP","mapTypeIds","MapTypeId","ROADMAP","SATELLITE","styleNoLabels","StyledMapType","mapTypes","styleDark","styleLight2","stylePgo","styleDarkNl","styleLight2Nl","stylePgoNl","addListener","s","mapTypeId","setMapTypeId","updateMap","getZoom","redrawPokemon","createSearchMarker","addMyLocationButton","initSidebar","updateSearchMarker","setIcon","icon","Marker","animation","Animation","DROP","draggable","optimized","zIndex","MAX_ZINDEX","isRangeActive","addRangeCircle","oldLocation","event","getPosition","newLocation","changeSearchLocation","done","setCenter","fail","setPosition","searchControlURI","searchControl","action","$","post","encodeURIComponent","updateSearchStatus","getJSON","then","data","prop","status","toggle","searchBox","places","SearchBox","css","setInterval","getPlaces","length","loc","geometry","location","changeLocation","icons","each","append","attr","text","pad","slice","getTypeSpan","pokemonLabel","rarity","types","disappearTime","latitude","longitude","disappearDate","Date","rarityDisplay","typesDisplay","index","contentstring","getHours","getMinutes","getSeconds","toFixed","gymLabel","teamName","teamId","gymPoints","lastScanned","members","memberStr","i","pokemon_name","trainer_name","trainer_level","pokemon_id","pokemon_cp","lastScannedStr","lastScannedDate","getFullYear","getMonth","getDate","nameStr","gymColor","gymPrestige","gymLevel","pokestopLabel","expireTime","expireDate","getGoogleSprite","sprite","displayHeight","Math","max","scale","scaledIconSize","Size","scaledIconOffset","Point","floor","scaledSpriteSize","scaledIconCenterOffset","url","size","scaledSize","origin","anchor","targetmap","circleCenter","LatLng","gymColors","circleColor","teamColor","rangeCircleOpts","radius","strokeWeight","strokeColor","strokeOpacity","fillColor","fillOpacity","Circle","setupPokemonMarker","item","skipNotification","isBounceDisabled","iconSize","pokemonIndex","animationDisabled","setAnimation","infoWindow","InfoWindow","content","disableAutoPan","indexOf","play","sendNotification","BOUNCE","addListeners","setupGymMarker","updateGymMarker","setContent","setupPokestopMarker","imagename","getColorByDate","diff","now","hue","join","setupScannedMarker","clickable","setupSpawnpointMarker","clearSelection","selection","empty","window","getSelection","removeAllRanges","open","updateLabelDiffTime","persist","close","clearStaleMarkers","getTime","showInBoundsMarkers","markers","show","getBounds","intersects","contains","team_id","getMap","oldAnimation","getAnimation","loadRawData","loadPokemon","loadGyms","loadPokestops","loadScanned","loadSpawnpoints","bounds","swPoint","getSouthWest","nePoint","getNorthEast","swLat","swLng","neLat","neLng","ajax","dataType","cache","beforeSend","complete","processPokemons","processPokestops","item2","processGyms","processScanned","scanId","setOptions","processSpawnpoints","result","hasClass","countMarkers","pokemonList","newMarker","element","disappearsAt","getAttribute","difference","abs","hours","minutes","seconds","timestring","getPointDistance","pointA","pointB","spherical","computeDistanceBetween","title","Notification","permission","requestPermission","notification","body","sound","onclick","focus","centerMap","myLocationButton","locationContainer","createElement","locationButton","backgroundColor","border","outline","width","height","borderRadius","boxShadow","cursor","marginRight","padding","appendChild","locationIcon","margin","backgroundImage","backgroundSize","backgroundPosition","backgroundRepeat","addEventListener","centerMapOnLocation","controls","RIGHT_BOTTOM","push","currentLocation","imgX","animationInterval","navigator","geolocation","getCurrentPosition","latlng","coords","setVisible","clearInterval","path","SymbolPath","CIRCLE","setZoom","i8ln","word","isEmptyObject","async","success","error","jqXHR","console","log","maxTouchPoints","styleList","select2","placeholder","minimumResultsForSearch","Infinity","on","e","searchMarkerStyleList","selectSearchIconMarker","formatState","state","$state","numberOfPokemon","pokeList","_types","pokemonType","templateResult","baseURL","protocol","hostname","port","lon","panTo","buildSwitchChangeListener","storageKey","checked","d","dType","change","options","wrapper","hide","bind","setDraggable","accordion","active","collapsible","heightStyle"],"mappings":"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","file":"map.built.js","sourcesContent":["//\r\n// Global map.js variables\r\n//\r\n\r\nvar $selectExclude\r\nvar $selectPokemonNotify\r\nvar $selectRarityNotify\r\nvar $selectStyle\r\nvar $selectIconResolution\r\nvar $selectIconSize\r\nvar $selectLuredPokestopsOnly\r\nvar $selectSearchIconMarker\r\n\r\nvar language = document.documentElement.lang === '' ? 'en' : document.documentElement.lang\r\nvar idToPokemon = {}\r\nvar i8lnDictionary = {}\r\nvar languageLookups = 0\r\nvar languageLookupThreshold = 3\r\n\r\nvar searchMarkerStyles\r\n\r\nvar excludedPokemon = []\r\nvar notifiedPokemon = []\r\nvar notifiedRarity = []\r\n\r\nvar map\r\nvar rawDataIsLoading = false\r\nvar locationMarker\r\nvar rangeMarkers = ['pokemon', 'pokestop', 'gym']\r\nvar searchMarker\r\nvar storeZoom = true\r\n\r\nvar noLabelsStyle = [{\r\n  featureType: 'poi',\r\n  elementType: 'labels',\r\n  stylers: [{\r\n    visibility: 'off'\r\n  }]\r\n}, {\r\n  'featureType': 'all',\r\n  'elementType': 'labels.text.stroke',\r\n  'stylers': [{\r\n    'visibility': 'off'\r\n  }]\r\n}, {\r\n  'featureType': 'all',\r\n  'elementType': 'labels.text.fill',\r\n  'stylers': [{\r\n    'visibility': 'off'\r\n  }]\r\n}, {\r\n  'featureType': 'all',\r\n  'elementType': 'labels.icon',\r\n  'stylers': [{\r\n    'visibility': 'off'\r\n  }]\r\n}]\r\nvar light2Style = [{\r\n  'elementType': 'geometry',\r\n  'stylers': [{\r\n    'hue': '#ff4400'\r\n  }, {\r\n    'saturation': -68\r\n  }, {\r\n    'lightness': -4\r\n  }, {\r\n    'gamma': 0.72\r\n  }]\r\n}, {\r\n  'featureType': 'road',\r\n  'elementType': 'labels.icon'\r\n}, {\r\n  'featureType': 'landscape.man_made',\r\n  'elementType': 'geometry',\r\n  'stylers': [{\r\n    'hue': '#0077ff'\r\n  }, {\r\n    'gamma': 3.1\r\n  }]\r\n}, {\r\n  'featureType': 'water',\r\n  'stylers': [{\r\n    'hue': '#00ccff'\r\n  }, {\r\n    'gamma': 0.44\r\n  }, {\r\n    'saturation': -33\r\n  }]\r\n}, {\r\n  'featureType': 'poi.park',\r\n  'stylers': [{\r\n    'hue': '#44ff00'\r\n  }, {\r\n    'saturation': -23\r\n  }]\r\n}, {\r\n  'featureType': 'water',\r\n  'elementType': 'labels.text.fill',\r\n  'stylers': [{\r\n    'hue': '#007fff'\r\n  }, {\r\n    'gamma': 0.77\r\n  }, {\r\n    'saturation': 65\r\n  }, {\r\n    'lightness': 99\r\n  }]\r\n}, {\r\n  'featureType': 'water',\r\n  'elementType': 'labels.text.stroke',\r\n  'stylers': [{\r\n    'gamma': 0.11\r\n  }, {\r\n    'weight': 5.6\r\n  }, {\r\n    'saturation': 99\r\n  }, {\r\n    'hue': '#0091ff'\r\n  }, {\r\n    'lightness': -86\r\n  }]\r\n}, {\r\n  'featureType': 'transit.line',\r\n  'elementType': 'geometry',\r\n  'stylers': [{\r\n    'lightness': -48\r\n  }, {\r\n    'hue': '#ff5e00'\r\n  }, {\r\n    'gamma': 1.2\r\n  }, {\r\n    'saturation': -23\r\n  }]\r\n}, {\r\n  'featureType': 'transit',\r\n  'elementType': 'labels.text.stroke',\r\n  'stylers': [{\r\n    'saturation': -64\r\n  }, {\r\n    'hue': '#ff9100'\r\n  }, {\r\n    'lightness': 16\r\n  }, {\r\n    'gamma': 0.47\r\n  }, {\r\n    'weight': 2.7\r\n  }]\r\n}]\r\nvar darkStyle = [{\r\n  'featureType': 'all',\r\n  'elementType': 'labels.text.fill',\r\n  'stylers': [{\r\n    'saturation': 36\r\n  }, {\r\n    'color': '#b39964'\r\n  }, {\r\n    'lightness': 40\r\n  }]\r\n}, {\r\n  'featureType': 'all',\r\n  'elementType': 'labels.text.stroke',\r\n  'stylers': [{\r\n    'visibility': 'on'\r\n  }, {\r\n    'color': '#000000'\r\n  }, {\r\n    'lightness': 16\r\n  }]\r\n}, {\r\n  'featureType': 'all',\r\n  'elementType': 'labels.icon',\r\n  'stylers': [{\r\n    'visibility': 'off'\r\n  }]\r\n}, {\r\n  'featureType': 'administrative',\r\n  'elementType': 'geometry.fill',\r\n  'stylers': [{\r\n    'color': '#000000'\r\n  }, {\r\n    'lightness': 20\r\n  }]\r\n}, {\r\n  'featureType': 'administrative',\r\n  'elementType': 'geometry.stroke',\r\n  'stylers': [{\r\n    'color': '#000000'\r\n  }, {\r\n    'lightness': 17\r\n  }, {\r\n    'weight': 1.2\r\n  }]\r\n}, {\r\n  'featureType': 'landscape',\r\n  'elementType': 'geometry',\r\n  'stylers': [{\r\n    'color': '#000000'\r\n  }, {\r\n    'lightness': 20\r\n  }]\r\n}, {\r\n  'featureType': 'poi',\r\n  'elementType': 'geometry',\r\n  'stylers': [{\r\n    'color': '#000000'\r\n  }, {\r\n    'lightness': 21\r\n  }]\r\n}, {\r\n  'featureType': 'road.highway',\r\n  'elementType': 'geometry.fill',\r\n  'stylers': [{\r\n    'color': '#000000'\r\n  }, {\r\n    'lightness': 17\r\n  }]\r\n}, {\r\n  'featureType': 'road.highway',\r\n  'elementType': 'geometry.stroke',\r\n  'stylers': [{\r\n    'color': '#000000'\r\n  }, {\r\n    'lightness': 29\r\n  }, {\r\n    'weight': 0.2\r\n  }]\r\n}, {\r\n  'featureType': 'road.arterial',\r\n  'elementType': 'geometry',\r\n  'stylers': [{\r\n    'color': '#000000'\r\n  }, {\r\n    'lightness': 18\r\n  }]\r\n}, {\r\n  'featureType': 'road.local',\r\n  'elementType': 'geometry',\r\n  'stylers': [{\r\n    'color': '#181818'\r\n  }, {\r\n    'lightness': 16\r\n  }]\r\n}, {\r\n  'featureType': 'transit',\r\n  'elementType': 'geometry',\r\n  'stylers': [{\r\n    'color': '#000000'\r\n  }, {\r\n    'lightness': 19\r\n  }]\r\n}, {\r\n  'featureType': 'water',\r\n  'elementType': 'geometry',\r\n  'stylers': [{\r\n    'lightness': 17\r\n  }, {\r\n    'color': '#525252'\r\n  }]\r\n}]\r\nvar pGoStyle = [{\r\n  'featureType': 'landscape.man_made',\r\n  'elementType': 'geometry.fill',\r\n  'stylers': [{\r\n    'color': '#a1f199'\r\n  }]\r\n}, {\r\n  'featureType': 'landscape.natural.landcover',\r\n  'elementType': 'geometry.fill',\r\n  'stylers': [{\r\n    'color': '#37bda2'\r\n  }]\r\n}, {\r\n  'featureType': 'landscape.natural.terrain',\r\n  'elementType': 'geometry.fill',\r\n  'stylers': [{\r\n    'color': '#37bda2'\r\n  }]\r\n}, {\r\n  'featureType': 'poi.attraction',\r\n  'elementType': 'geometry.fill',\r\n  'stylers': [{\r\n    'visibility': 'on'\r\n  }]\r\n}, {\r\n  'featureType': 'poi.business',\r\n  'elementType': 'geometry.fill',\r\n  'stylers': [{\r\n    'color': '#e4dfd9'\r\n  }]\r\n}, {\r\n  'featureType': 'poi.business',\r\n  'elementType': 'labels.icon',\r\n  'stylers': [{\r\n    'visibility': 'off'\r\n  }]\r\n}, {\r\n  'featureType': 'poi.park',\r\n  'elementType': 'geometry.fill',\r\n  'stylers': [{\r\n    'color': '#37bda2'\r\n  }]\r\n}, {\r\n  'featureType': 'road',\r\n  'elementType': 'geometry.fill',\r\n  'stylers': [{\r\n    'color': '#84b09e'\r\n  }]\r\n}, {\r\n  'featureType': 'road',\r\n  'elementType': 'geometry.stroke',\r\n  'stylers': [{\r\n    'color': '#fafeb8'\r\n  }, {\r\n    'weight': '1.25'\r\n  }]\r\n}, {\r\n  'featureType': 'road.highway',\r\n  'elementType': 'labels.icon',\r\n  'stylers': [{\r\n    'visibility': 'off'\r\n  }]\r\n}, {\r\n  'featureType': 'water',\r\n  'elementType': 'geometry.fill',\r\n  'stylers': [{\r\n    'color': '#5ddad6'\r\n  }]\r\n}]\r\nvar light2StyleNoLabels = [{\r\n  'elementType': 'geometry',\r\n  'stylers': [{\r\n    'hue': '#ff4400'\r\n  }, {\r\n    'saturation': -68\r\n  }, {\r\n    'lightness': -4\r\n  }, {\r\n    'gamma': 0.72\r\n  }]\r\n}, {\r\n  'featureType': 'road',\r\n  'elementType': 'labels.icon'\r\n}, {\r\n  'featureType': 'landscape.man_made',\r\n  'elementType': 'geometry',\r\n  'stylers': [{\r\n    'hue': '#0077ff'\r\n  }, {\r\n    'gamma': 3.1\r\n  }]\r\n}, {\r\n  'featureType': 'water',\r\n  'stylers': [{\r\n    'hue': '#00ccff'\r\n  }, {\r\n    'gamma': 0.44\r\n  }, {\r\n    'saturation': -33\r\n  }]\r\n}, {\r\n  'featureType': 'poi.park',\r\n  'stylers': [{\r\n    'hue': '#44ff00'\r\n  }, {\r\n    'saturation': -23\r\n  }]\r\n}, {\r\n  'featureType': 'water',\r\n  'elementType': 'labels.text.fill',\r\n  'stylers': [{\r\n    'hue': '#007fff'\r\n  }, {\r\n    'gamma': 0.77\r\n  }, {\r\n    'saturation': 65\r\n  }, {\r\n    'lightness': 99\r\n  }]\r\n}, {\r\n  'featureType': 'water',\r\n  'elementType': 'labels.text.stroke',\r\n  'stylers': [{\r\n    'gamma': 0.11\r\n  }, {\r\n    'weight': 5.6\r\n  }, {\r\n    'saturation': 99\r\n  }, {\r\n    'hue': '#0091ff'\r\n  }, {\r\n    'lightness': -86\r\n  }]\r\n}, {\r\n  'featureType': 'transit.line',\r\n  'elementType': 'geometry',\r\n  'stylers': [{\r\n    'lightness': -48\r\n  }, {\r\n    'hue': '#ff5e00'\r\n  }, {\r\n    'gamma': 1.2\r\n  }, {\r\n    'saturation': -23\r\n  }]\r\n}, {\r\n  'featureType': 'transit',\r\n  'elementType': 'labels.text.stroke',\r\n  'stylers': [{\r\n    'saturation': -64\r\n  }, {\r\n    'hue': '#ff9100'\r\n  }, {\r\n    'lightness': 16\r\n  }, {\r\n    'gamma': 0.47\r\n  }, {\r\n    'weight': 2.7\r\n  }]\r\n}, {\r\n  'featureType': 'all',\r\n  'elementType': 'labels.text.stroke',\r\n  'stylers': [{\r\n    'visibility': 'off'\r\n  }]\r\n}, {\r\n  'featureType': 'all',\r\n  'elementType': 'labels.text.fill',\r\n  'stylers': [{\r\n    'visibility': 'off'\r\n  }]\r\n}, {\r\n  'featureType': 'all',\r\n  'elementType': 'labels.icon',\r\n  'stylers': [{\r\n    'visibility': 'off'\r\n  }]\r\n}]\r\nvar darkStyleNoLabels = [{\r\n  'featureType': 'all',\r\n  'elementType': 'labels.text.fill',\r\n  'stylers': [{\r\n    'visibility': 'off'\r\n  }]\r\n}, {\r\n  'featureType': 'all',\r\n  'elementType': 'labels.text.stroke',\r\n  'stylers': [{\r\n    'visibility': 'off'\r\n  }]\r\n}, {\r\n  'featureType': 'all',\r\n  'elementType': 'labels.icon',\r\n  'stylers': [{\r\n    'visibility': 'off'\r\n  }]\r\n}, {\r\n  'featureType': 'administrative',\r\n  'elementType': 'geometry.fill',\r\n  'stylers': [{\r\n    'color': '#000000'\r\n  }, {\r\n    'lightness': 20\r\n  }]\r\n}, {\r\n  'featureType': 'administrative',\r\n  'elementType': 'geometry.stroke',\r\n  'stylers': [{\r\n    'color': '#000000'\r\n  }, {\r\n    'lightness': 17\r\n  }, {\r\n    'weight': 1.2\r\n  }]\r\n}, {\r\n  'featureType': 'landscape',\r\n  'elementType': 'geometry',\r\n  'stylers': [{\r\n    'color': '#000000'\r\n  }, {\r\n    'lightness': 20\r\n  }]\r\n}, {\r\n  'featureType': 'poi',\r\n  'elementType': 'geometry',\r\n  'stylers': [{\r\n    'color': '#000000'\r\n  }, {\r\n    'lightness': 21\r\n  }]\r\n}, {\r\n  'featureType': 'road.highway',\r\n  'elementType': 'geometry.fill',\r\n  'stylers': [{\r\n    'color': '#000000'\r\n  }, {\r\n    'lightness': 17\r\n  }]\r\n}, {\r\n  'featureType': 'road.highway',\r\n  'elementType': 'geometry.stroke',\r\n  'stylers': [{\r\n    'color': '#000000'\r\n  }, {\r\n    'lightness': 29\r\n  }, {\r\n    'weight': 0.2\r\n  }]\r\n}, {\r\n  'featureType': 'road.arterial',\r\n  'elementType': 'geometry',\r\n  'stylers': [{\r\n    'color': '#000000'\r\n  }, {\r\n    'lightness': 18\r\n  }]\r\n}, {\r\n  'featureType': 'road.local',\r\n  'elementType': 'geometry',\r\n  'stylers': [{\r\n    'color': '#181818'\r\n  }, {\r\n    'lightness': 16\r\n  }]\r\n}, {\r\n  'featureType': 'transit',\r\n  'elementType': 'geometry',\r\n  'stylers': [{\r\n    'color': '#000000'\r\n  }, {\r\n    'lightness': 19\r\n  }]\r\n}, {\r\n  'featureType': 'water',\r\n  'elementType': 'geometry',\r\n  'stylers': [{\r\n    'lightness': 17\r\n  }, {\r\n    'color': '#525252'\r\n  }]\r\n}]\r\nvar pGoStyleNoLabels = [{\r\n  'featureType': 'landscape.man_made',\r\n  'elementType': 'geometry.fill',\r\n  'stylers': [{\r\n    'color': '#a1f199'\r\n  }]\r\n}, {\r\n  'featureType': 'landscape.natural.landcover',\r\n  'elementType': 'geometry.fill',\r\n  'stylers': [{\r\n    'color': '#37bda2'\r\n  }]\r\n}, {\r\n  'featureType': 'landscape.natural.terrain',\r\n  'elementType': 'geometry.fill',\r\n  'stylers': [{\r\n    'color': '#37bda2'\r\n  }]\r\n}, {\r\n  'featureType': 'poi.attraction',\r\n  'elementType': 'geometry.fill',\r\n  'stylers': [{\r\n    'visibility': 'on'\r\n  }]\r\n}, {\r\n  'featureType': 'poi.business',\r\n  'elementType': 'geometry.fill',\r\n  'stylers': [{\r\n    'color': '#e4dfd9'\r\n  }]\r\n}, {\r\n  'featureType': 'poi.business',\r\n  'elementType': 'labels.icon',\r\n  'stylers': [{\r\n    'visibility': 'off'\r\n  }]\r\n}, {\r\n  'featureType': 'poi.park',\r\n  'elementType': 'geometry.fill',\r\n  'stylers': [{\r\n    'color': '#37bda2'\r\n  }]\r\n}, {\r\n  'featureType': 'road',\r\n  'elementType': 'geometry.fill',\r\n  'stylers': [{\r\n    'color': '#84b09e'\r\n  }]\r\n}, {\r\n  'featureType': 'road',\r\n  'elementType': 'geometry.stroke',\r\n  'stylers': [{\r\n    'color': '#fafeb8'\r\n  }, {\r\n    'weight': '1.25'\r\n  }]\r\n}, {\r\n  'featureType': 'road.highway',\r\n  'elementType': 'labels.icon',\r\n  'stylers': [{\r\n    'visibility': 'off'\r\n  }]\r\n}, {\r\n  'featureType': 'water',\r\n  'elementType': 'geometry.fill',\r\n  'stylers': [{\r\n    'color': '#5ddad6'\r\n  }]\r\n}, {\r\n  'featureType': 'all',\r\n  'elementType': 'labels.text.stroke',\r\n  'stylers': [{\r\n    'visibility': 'off'\r\n  }]\r\n}, {\r\n  'featureType': 'all',\r\n  'elementType': 'labels.text.fill',\r\n  'stylers': [{\r\n    'visibility': 'off'\r\n  }]\r\n}, {\r\n  'featureType': 'all',\r\n  'elementType': 'labels.icon',\r\n  'stylers': [{\r\n    'visibility': 'off'\r\n  }]\r\n}]\r\n\r\nvar selectedStyle = 'light'\r\n\r\nvar mapData = {\r\n  pokemons: {},\r\n  gyms: {},\r\n  pokestops: {},\r\n  lurePokemons: {},\r\n  scanned: {},\r\n  spawnpoints: {}\r\n}\r\nvar gymTypes = ['Uncontested', 'Mystic', 'Valor', 'Instinct']\r\nvar audio = new Audio('static/sounds/ding.mp3')\r\nvar pokemonSprites = {\r\n  normal: {\r\n    columns: 12,\r\n    iconWidth: 30,\r\n    iconHeight: 30,\r\n    spriteWidth: 360,\r\n    spriteHeight: 390,\r\n    filename: 'static/icons-sprite.png',\r\n    name: 'Normal'\r\n  },\r\n  highres: {\r\n    columns: 7,\r\n    iconWidth: 65,\r\n    iconHeight: 65,\r\n    spriteWidth: 455,\r\n    spriteHeight: 1430,\r\n    filename: 'static/icons-large-sprite.png',\r\n    name: 'High-Res'\r\n  },\r\n  shuffle: {\r\n    columns: 7,\r\n    iconWidth: 65,\r\n    iconHeight: 65,\r\n    spriteWidth: 455,\r\n    spriteHeight: 1430,\r\n    filename: 'static/icons-shuffle-sprite.png',\r\n    name: 'Shuffle'\r\n  }\r\n}\r\n\r\n//\r\n// LocalStorage helpers\r\n//\r\n\r\nvar StoreTypes = {\r\n  Boolean: {\r\n    parse: function (str) {\r\n      switch (str.toLowerCase()) {\r\n        case '1':\r\n        case 'true':\r\n        case 'yes':\r\n          return true\r\n        default:\r\n          return false\r\n      }\r\n    },\r\n    stringify: function (b) {\r\n      return b ? 'true' : 'false'\r\n    }\r\n  },\r\n  JSON: {\r\n    parse: function (str) {\r\n      return JSON.parse(str)\r\n    },\r\n    stringify: function (json) {\r\n      return JSON.stringify(json)\r\n    }\r\n  },\r\n  String: {\r\n    parse: function (str) {\r\n      return str\r\n    },\r\n    stringify: function (str) {\r\n      return str\r\n    }\r\n  },\r\n  Number: {\r\n    parse: function (str) {\r\n      return parseInt(str, 10)\r\n    },\r\n    stringify: function (number) {\r\n      return number.toString()\r\n    }\r\n  }\r\n}\r\n\r\nvar StoreOptions = {\r\n  'map_style': {\r\n    default: 'roadmap',\r\n    type: StoreTypes.String\r\n  },\r\n  'remember_select_exclude': {\r\n    default: [],\r\n    type: StoreTypes.JSON\r\n  },\r\n  'remember_select_notify': {\r\n    default: [],\r\n    type: StoreTypes.JSON\r\n  },\r\n  'remember_select_rarity_notify': {\r\n    default: [],\r\n    type: StoreTypes.JSON\r\n  },\r\n  'showGyms': {\r\n    default: false,\r\n    type: StoreTypes.Boolean\r\n  },\r\n  'showPokemon': {\r\n    default: true,\r\n    type: StoreTypes.Boolean\r\n  },\r\n  'showPokestops': {\r\n    default: true,\r\n    type: StoreTypes.Boolean\r\n  },\r\n  'showLuredPokestopsOnly': {\r\n    default: 0,\r\n    type: StoreTypes.Number\r\n  },\r\n  'showScanned': {\r\n    default: false,\r\n    type: StoreTypes.Boolean\r\n  },\r\n  'showSpawnpoints': {\r\n    default: false,\r\n    type: StoreTypes.Boolean\r\n  },\r\n  'showRanges': {\r\n    default: false,\r\n    type: StoreTypes.Boolean\r\n  },\r\n  'playSound': {\r\n    default: false,\r\n    type: StoreTypes.Boolean\r\n  },\r\n  'geoLocate': {\r\n    default: false,\r\n    type: StoreTypes.Boolean\r\n  },\r\n  'lockMarker': {\r\n    default: isTouchDevice(), // default to true if touch device\r\n    type: StoreTypes.Boolean\r\n  },\r\n  'startAtUserLocation': {\r\n    default: false,\r\n    type: StoreTypes.Boolean\r\n  },\r\n  'pokemonIcons': {\r\n    default: 'highres',\r\n    type: StoreTypes.String\r\n  },\r\n  'iconSizeModifier': {\r\n    default: 0,\r\n    type: StoreTypes.Number\r\n  },\r\n  'searchMarkerStyle': {\r\n    default: 'google',\r\n    type: StoreTypes.String\r\n  },\r\n  'zoomLevel': {\r\n    default: 16,\r\n    type: StoreTypes.Number\r\n  }\r\n}\r\n\r\nvar Store = {\r\n  getOption: function (key) {\r\n    var option = StoreOptions[key]\r\n    if (!option) {\r\n      throw new Error('Store key was not defined ' + key)\r\n    }\r\n    return option\r\n  },\r\n  get: function (key) {\r\n    var option = this.getOption(key)\r\n    var optionType = option.type\r\n    var rawValue = localStorage[key]\r\n    if (rawValue === null || rawValue === undefined) {\r\n      return option.default\r\n    }\r\n    var value = optionType.parse(rawValue)\r\n    return value\r\n  },\r\n  set: function (key, value) {\r\n    var option = this.getOption(key)\r\n    var optionType = option.type || StoreTypes.String\r\n    var rawValue = optionType.stringify(value)\r\n    localStorage[key] = rawValue\r\n  },\r\n  reset: function (key) {\r\n    localStorage.removeItem(key)\r\n  }\r\n}\r\n\r\n//\r\n// Functions\r\n//\r\n\r\nfunction excludePokemon (id) { // eslint-disable-line no-unused-vars\r\n  $selectExclude.val(\r\n    $selectExclude.val().concat(id)\r\n  ).trigger('change')\r\n}\r\n\r\nfunction notifyAboutPokemon (id) { // eslint-disable-line no-unused-vars\r\n  $selectPokemonNotify.val(\r\n    $selectPokemonNotify.val().concat(id)\r\n  ).trigger('change')\r\n}\r\n\r\nfunction removePokemonMarker (encounterId) { // eslint-disable-line no-unused-vars\r\n  if (mapData.pokemons[encounterId].marker.rangeCircle) {\r\n    mapData.pokemons[encounterId].marker.rangeCircle.setMap(null)\r\n    delete mapData.pokemons[encounterId].marker.rangeCircle\r\n  }\r\n  mapData.pokemons[encounterId].marker.setMap(null)\r\n  mapData.pokemons[encounterId].hidden = true\r\n}\r\n\r\nfunction initMap () { // eslint-disable-line no-unused-vars\r\n  map = new google.maps.Map(document.getElementById('map'), {\r\n    center: {\r\n      lat: centerLat,\r\n      lng: centerLng\r\n    },\r\n    zoom: Store.get('zoomLevel'),\r\n    fullscreenControl: true,\r\n    streetViewControl: false,\r\n    mapTypeControl: false,\r\n    mapTypeControlOptions: {\r\n      style: google.maps.MapTypeControlStyle.DROPDOWN_MENU,\r\n      position: google.maps.ControlPosition.RIGHT_TOP,\r\n      mapTypeIds: [\r\n        google.maps.MapTypeId.ROADMAP,\r\n        google.maps.MapTypeId.SATELLITE,\r\n        'nolabels_style',\r\n        'dark_style',\r\n        'style_light2',\r\n        'style_pgo',\r\n        'dark_style_nl',\r\n        'style_light2_nl',\r\n        'style_pgo_nl'\r\n      ]\r\n    }\r\n  })\r\n\r\n  var styleNoLabels = new google.maps.StyledMapType(noLabelsStyle, {\r\n    name: 'No Labels'\r\n  })\r\n  map.mapTypes.set('nolabels_style', styleNoLabels)\r\n\r\n  var styleDark = new google.maps.StyledMapType(darkStyle, {\r\n    name: 'Dark'\r\n  })\r\n  map.mapTypes.set('dark_style', styleDark)\r\n\r\n  var styleLight2 = new google.maps.StyledMapType(light2Style, {\r\n    name: 'Light2'\r\n  })\r\n  map.mapTypes.set('style_light2', styleLight2)\r\n\r\n  var stylePgo = new google.maps.StyledMapType(pGoStyle, {\r\n    name: 'PokemonGo'\r\n  })\r\n  map.mapTypes.set('style_pgo', stylePgo)\r\n\r\n  var styleDarkNl = new google.maps.StyledMapType(darkStyleNoLabels, {\r\n    name: 'Dark (No Labels)'\r\n  })\r\n  map.mapTypes.set('dark_style_nl', styleDarkNl)\r\n\r\n  var styleLight2Nl = new google.maps.StyledMapType(light2StyleNoLabels, {\r\n    name: 'Light2 (No Labels)'\r\n  })\r\n  map.mapTypes.set('style_light2_nl', styleLight2Nl)\r\n\r\n  var stylePgoNl = new google.maps.StyledMapType(pGoStyleNoLabels, {\r\n    name: 'PokemonGo (No Labels)'\r\n  })\r\n  map.mapTypes.set('style_pgo_nl', stylePgoNl)\r\n\r\n  map.addListener('maptypeid_changed', function (s) {\r\n    Store.set('map_style', this.mapTypeId)\r\n  })\r\n\r\n  map.setMapTypeId(Store.get('map_style'))\r\n  map.addListener('idle', updateMap)\r\n\r\n  map.addListener('zoom_changed', function () {\r\n    if (storeZoom === true) {\r\n      Store.set('zoomLevel', this.getZoom())\r\n    } else {\r\n      storeZoom = true\r\n    }\r\n\r\n    redrawPokemon(mapData.pokemons)\r\n    redrawPokemon(mapData.lurePokemons)\r\n  })\r\n\r\n  searchMarker = createSearchMarker()\r\n\r\n  addMyLocationButton()\r\n  initSidebar()\r\n}\r\n\r\nfunction updateSearchMarker (style) {\r\n  if (style in searchMarkerStyles) {\r\n    searchMarker.setIcon(searchMarkerStyles[style].icon)\r\n    Store.set('searchMarkerStyle', style)\r\n  }\r\n  return searchMarker\r\n}\r\n\r\nfunction createSearchMarker () {\r\n  var searchMarker = new google.maps.Marker({ // need to keep reference.\r\n    position: {\r\n      lat: centerLat,\r\n      lng: centerLng\r\n    },\r\n    map: map,\r\n    animation: google.maps.Animation.DROP,\r\n    draggable: !Store.get('lockMarker'),\r\n    icon: null,\r\n    optimized: false,\r\n    zIndex: google.maps.Marker.MAX_ZINDEX + 1\r\n  })\r\n\r\n  if (!searchMarker.rangeCircle && isRangeActive(map)) {\r\n    searchMarker.rangeCircle = addRangeCircle(searchMarker, map, 'search')\r\n  }\r\n  var oldLocation = null\r\n  google.maps.event.addListener(searchMarker, 'dragstart', function () {\r\n    oldLocation = searchMarker.getPosition()\r\n  })\r\n\r\n  google.maps.event.addListener(searchMarker, 'dragend', function () {\r\n    var newLocation = searchMarker.getPosition()\r\n    changeSearchLocation(newLocation.lat(), newLocation.lng())\r\n      .done(function () {\r\n        oldLocation = null\r\n        if (searchMarker.rangeCircle && Store.get('showRanges')) {\r\n          searchMarker.rangeCircle.setCenter(newLocation)\r\n        }\r\n      })\r\n      .fail(function () {\r\n        if (oldLocation) {\r\n          searchMarker.setPosition(oldLocation)\r\n        }\r\n      })\r\n  })\r\n\r\n  return searchMarker\r\n}\r\n\r\nvar searchControlURI = 'search_control'\r\nfunction searchControl (action) {\r\n  $.post(searchControlURI + '?action=' + encodeURIComponent(action))\r\n}\r\nfunction updateSearchStatus () {\r\n  $.getJSON(searchControlURI).then(function (data) {\r\n    $('#search-switch').prop('checked', data.status)\r\n  })\r\n}\r\n\r\nfunction initSidebar () {\r\n  $('#gyms-switch').prop('checked', Store.get('showGyms'))\r\n  $('#pokemon-switch').prop('checked', Store.get('showPokemon'))\r\n  $('#pokestops-switch').prop('checked', Store.get('showPokestops'))\r\n  $('#lured-pokestops-only-switch').val(Store.get('showLuredPokestopsOnly'))\r\n  $('#lured-pokestops-only-wrapper').toggle(Store.get('showPokestops'))\r\n  $('#geoloc-switch').prop('checked', Store.get('geoLocate'))\r\n  $('#lock-marker-switch').prop('checked', Store.get('lockMarker'))\r\n  $('#start-at-user-location-switch').prop('checked', Store.get('startAtUserLocation'))\r\n  $('#scanned-switch').prop('checked', Store.get('showScanned'))\r\n  $('#spawnpoints-switch').prop('checked', Store.get('showSpawnpoints'))\r\n  $('#ranges-switch').prop('checked', Store.get('showRanges'))\r\n  $('#sound-switch').prop('checked', Store.get('playSound'))\r\n  var searchBox = new google.maps.places.SearchBox(document.getElementById('next-location'))\r\n  $('#next-location').css('background-color', $('#geoloc-switch').prop('checked') ? '#e0e0e0' : '#ffffff')\r\n\r\n  updateSearchStatus()\r\n  setInterval(updateSearchStatus, 5000)\r\n\r\n  searchBox.addListener('places_changed', function () {\r\n    var places = searchBox.getPlaces()\r\n\r\n    if (places.length === 0) {\r\n      return\r\n    }\r\n\r\n    var loc = places[0].geometry.location\r\n    changeLocation(loc.lat(), loc.lng())\r\n  })\r\n\r\n  var icons = $('#pokemon-icons')\r\n  $.each(pokemonSprites, function (key, value) {\r\n    icons.append($('<option></option>').attr('value', key).text(value.name))\r\n  })\r\n  icons.val((pokemonSprites[Store.get('pokemonIcons')]) ? Store.get('pokemonIcons') : 'highres')\r\n  $('#pokemon-icon-size').val(Store.get('iconSizeModifier'))\r\n}\r\n\r\nfunction pad (number) {\r\n  return number <= 99 ? ('0' + number).slice(-2) : number\r\n}\r\n\r\nfunction getTypeSpan (type) {\r\n  return `<span style='padding: 2px 5px; text-transform: uppercase; color: white; margin-right: 2px; border-radius: 4px; font-size: 0.8em; vertical-align: text-bottom; background-color: ${type['color']}'>${type['type']}</span>`\r\n}\r\n\r\nfunction pokemonLabel (name, rarity, types, disappearTime, id, latitude, longitude, encounterId) {\r\n  var disappearDate = new Date(disappearTime)\r\n  var rarityDisplay = rarity ? '(' + rarity + ')' : ''\r\n  var typesDisplay = ''\r\n  $.each(types, function (index, type) {\r\n    typesDisplay += getTypeSpan(type)\r\n  })\r\n\r\n  var contentstring = `\r\n    <div>\r\n      <b>${name}</b>\r\n      <span> - </span>\r\n      <small>\r\n        <a href='http://www.pokemon.com/us/pokedex/${id}' target='_blank' title='View in Pokedex'>#${id}</a>\r\n      </small>\r\n      <span> ${rarityDisplay}</span>\r\n      <span> - </span>\r\n      <small>${typesDisplay}</small>\r\n    </div>\r\n    <div>\r\n      Disappears at ${pad(disappearDate.getHours())}:${pad(disappearDate.getMinutes())}:${pad(disappearDate.getSeconds())}\r\n      <span class='label-countdown' disappears-at='${disappearTime}'>(00m00s)</span>\r\n    </div>\r\n    <div>\r\n      Location: ${latitude.toFixed(6)}, ${longitude.toFixed(7)}\r\n    </div>\r\n    <div>\r\n      <a href='javascript:excludePokemon(${id})'>Exclude</a>&nbsp;&nbsp\r\n      <a href='javascript:notifyAboutPokemon(${id})'>Notify</a>&nbsp;&nbsp\r\n      <a href='javascript:removePokemonMarker(\"${encounterId}\")'>Remove</a>&nbsp;&nbsp\r\n      <a href='https://www.google.com/maps/dir/Current+Location/${latitude},${longitude}?hl=en' target='_blank' title='View in Maps'>Get directions</a>\r\n    </div>`\r\n  return contentstring\r\n}\r\n\r\nfunction gymLabel (teamName, teamId, gymPoints, latitude, longitude, lastScanned = null, name = null, members = []) {\r\n  var memberStr = ''\r\n  for (var i = 0; i < members.length; i++) {\r\n    memberStr += `\r\n      <span class=\"gym-member\" title=\"${members[i].pokemon_name} | ${members[i].trainer_name} (Lvl ${members[i].trainer_level})\">\r\n        <i class=\"pokemon-sprite n${members[i].pokemon_id}\"></i>\r\n        <span class=\"cp team-${teamId}\">${members[i].pokemon_cp}</span>\r\n      </span>`\r\n  }\r\n\r\n  var lastScannedStr\r\n  if (lastScanned) {\r\n    var lastScannedDate = new Date(lastScanned)\r\n    lastScannedStr = `${lastScannedDate.getFullYear()}-${pad(lastScannedDate.getMonth() + 1)}-${lastScannedDate.getDate()} ${pad(lastScannedDate.getHours())}:${pad(lastScannedDate.getMinutes())}:${pad(lastScannedDate.getSeconds())}`\r\n  } else {\r\n    lastScannedStr = 'Unknown'\r\n  }\r\n\r\n  var nameStr = (name ? `<div>${name}</div>` : '')\r\n\r\n  var gymColor = ['0, 0, 0, .4', '74, 138, 202, .6', '240, 68, 58, .6', '254, 217, 40, .6']\r\n  var str\r\n  if (teamId === 0) {\r\n    str = `\r\n      <div>\r\n        <center>\r\n          <div>\r\n            <b style='color:rgba(${gymColor[teamId]})'>${teamName}</b><br>\r\n            <img height='70px' style='padding: 5px;' src='static/forts/${teamName}_large.png'>\r\n          </div>\r\n          ${nameStr}\r\n          <div>\r\n            Location: ${latitude.toFixed(6)}, ${longitude.toFixed(7)}\r\n          </div>\r\n          <div>\r\n            Last Scanned: ${lastScannedStr}\r\n          </div>\r\n          <div>\r\n            <a href='https://www.google.com/maps/dir/Current+Location/${latitude},${longitude}?hl=en' target='_blank' title='View in Maps'>Get directions</a>\r\n          </div>\r\n        </center>\r\n      </div>`\r\n  } else {\r\n    var gymPrestige = [2000, 4000, 8000, 12000, 16000, 20000, 30000, 40000, 50000]\r\n    var gymLevel = 1\r\n    while (gymPoints >= gymPrestige[gymLevel - 1]) {\r\n      gymLevel++\r\n    }\r\n    str = `\r\n      <div>\r\n        <center>\r\n          <div style='padding-bottom: 2px'>\r\n            Gym owned by:\r\n          </div>\r\n          <div>\r\n            <b style='color:rgba(${gymColor[teamId]})'>Team ${teamName}</b><br>\r\n            <img height='70px' style='padding: 5px;' src='static/forts/${teamName}_large.png'>\r\n          </div>\r\n          <div>\r\n            ${nameStr}\r\n          </div>\r\n          <div>\r\n            Level: ${gymLevel} | Prestige: ${gymPoints}/${gymPrestige[gymLevel - 1] || 50000}\r\n          </div>\r\n          <div>\r\n            ${memberStr}\r\n          </div>\r\n          <div>\r\n            Location: ${latitude.toFixed(6)}, ${longitude.toFixed(7)}\r\n          </div>\r\n          <div>\r\n            Last Scanned: ${lastScannedStr}\r\n          </div>\r\n          <div>\r\n            <a href='https://www.google.com/maps/dir/Current+Location/${latitude},${longitude}?hl=en' target='_blank' title='View in Maps'>Get directions</a>\r\n          </div>\r\n        </center>\r\n      </div>`\r\n  }\r\n\r\n  return str\r\n}\r\n\r\nfunction pokestopLabel (expireTime, latitude, longitude) {\r\n  var str\r\n  if (expireTime) {\r\n    var expireDate = new Date(expireTime)\r\n\r\n    str = `\r\n      <div>\r\n        <b>Lured Pokstop</b>\r\n      </div>\r\n      <div>\r\n        Lure expires at ${pad(expireDate.getHours())}:${pad(expireDate.getMinutes())}:${pad(expireDate.getSeconds())}\r\n        <span class='label-countdown' disappears-at='${expireTime}'>(00m00s)</span>\r\n      </div>\r\n      <div>\r\n        Location: ${latitude.toFixed(6)}, ${longitude.toFixed(7)}\r\n      </div>\r\n      <div>\r\n        <a href='https://www.google.com/maps/dir/Current+Location/${latitude},${longitude}?hl=en' target='_blank' title='View in Maps'>Get directions</a>\r\n      </div>`\r\n  } else {\r\n    str = `\r\n      <div>\r\n        <b>Pokstop</b>\r\n      </div>\r\n      <div>\r\n        Location: ${latitude.toFixed(6)}, ${longitude.toFixed(7)}\r\n      </div>\r\n      <div>\r\n        <a href='https://www.google.com/maps/dir/Current+Location/${latitude},${longitude}?hl=en' target='_blank' title='View in Maps'>Get directions</a>\r\n      </div>`\r\n  }\r\n\r\n  return str\r\n}\r\n\r\nfunction getGoogleSprite (index, sprite, displayHeight) {\r\n  displayHeight = Math.max(displayHeight, 3)\r\n  var scale = displayHeight / sprite.iconHeight\r\n  // Crop icon just a tiny bit to avoid bleedover from neighbor\r\n  var scaledIconSize = new google.maps.Size(scale * sprite.iconWidth - 1, scale * sprite.iconHeight - 1)\r\n  var scaledIconOffset = new google.maps.Point(\r\n    (index % sprite.columns) * sprite.iconWidth * scale + 0.5,\r\n    Math.floor(index / sprite.columns) * sprite.iconHeight * scale + 0.5)\r\n  var scaledSpriteSize = new google.maps.Size(scale * sprite.spriteWidth, scale * sprite.spriteHeight)\r\n  var scaledIconCenterOffset = new google.maps.Point(scale * sprite.iconWidth / 2, scale * sprite.iconHeight / 2)\r\n\r\n  return {\r\n    url: sprite.filename,\r\n    size: scaledIconSize,\r\n    scaledSize: scaledSpriteSize,\r\n    origin: scaledIconOffset,\r\n    anchor: scaledIconCenterOffset\r\n  }\r\n}\r\n\r\nfunction addRangeCircle (marker, map, type, teamId) {\r\n  var targetmap = null\r\n  var circleCenter = new google.maps.LatLng(marker.position.lat(), marker.position.lng())\r\n  var gymColors = ['#999999', '#0051CF', '#FF260E', '#FECC23'] // 'Uncontested', 'Mystic', 'Valor', 'Instinct']\r\n  var circleColor = '#cccccc'\r\n  var teamColor = gymColors[0]\r\n  if (teamId) teamColor = gymColors[teamId]\r\n\r\n  if (type === 'search') circleColor = '#333333'\r\n  if (type === 'pokemon') circleColor = '#C233F2'\r\n  if (type === 'pokestop') circleColor = '#3EB0FF'\r\n  if (type === 'gym') circleColor = teamColor\r\n\r\n  if (map) targetmap = map\r\n\r\n  var rangeCircleOpts = {\r\n    map: targetmap,\r\n    radius: 40,    // 40 meters\r\n    strokeWeight: 1,\r\n    strokeColor: circleColor,\r\n    strokeOpacity: 0.9,\r\n    center: circleCenter,\r\n    fillColor: circleColor,\r\n    fillOpacity: 0.3\r\n  }\r\n  var rangeCircle = new google.maps.Circle(rangeCircleOpts)\r\n  return rangeCircle\r\n}\r\n\r\nfunction isRangeActive (map) {\r\n  if (map.getZoom() < 16) return false\r\n  return Store.get('showRanges')\r\n}\r\n\r\nfunction setupPokemonMarker (item, skipNotification, isBounceDisabled) {\r\n  // Scale icon size up with the map exponentially\r\n  var iconSize = 2 + (map.getZoom() - 3) * (map.getZoom() - 3) * 0.2 + Store.get('iconSizeModifier')\r\n  var pokemonIndex = item['pokemon_id'] - 1\r\n  var sprite = pokemonSprites[Store.get('pokemonIcons')] || pokemonSprites['highres']\r\n  var icon = getGoogleSprite(pokemonIndex, sprite, iconSize)\r\n\r\n  var animationDisabled = false\r\n  if (isBounceDisabled === true) {\r\n    animationDisabled = true\r\n  }\r\n\r\n  var marker = new google.maps.Marker({\r\n    position: {\r\n      lat: item['latitude'],\r\n      lng: item['longitude']\r\n    },\r\n    zIndex: 9999,\r\n    map: map,\r\n    icon: icon,\r\n    animationDisabled: animationDisabled\r\n  })\r\n\r\n  marker.addListener('click', function () {\r\n    this.setAnimation(null)\r\n    this.animationDisabled = true\r\n  })\r\n\r\n  if (!marker.rangeCircle && isRangeActive(map)) {\r\n    marker.rangeCircle = addRangeCircle(marker, map, 'pokemon')\r\n  }\r\n\r\n  marker.infoWindow = new google.maps.InfoWindow({\r\n    content: pokemonLabel(item['pokemon_name'], item['pokemon_rarity'], item['pokemon_types'], item['disappear_time'], item['pokemon_id'], item['latitude'], item['longitude'], item['encounter_id']),\r\n    disableAutoPan: true\r\n  })\r\n\r\n  if (notifiedPokemon.indexOf(item['pokemon_id']) > -1 || notifiedRarity.indexOf(item['pokemon_rarity']) > -1) {\r\n    if (!skipNotification) {\r\n      if (Store.get('playSound')) {\r\n        audio.play()\r\n      }\r\n      sendNotification('A wild ' + item['pokemon_name'] + ' appeared!', 'Click to load map', 'static/icons/' + item['pokemon_id'] + '.png', item['latitude'], item['longitude'])\r\n    }\r\n    if (marker.animationDisabled !== true) {\r\n      marker.setAnimation(google.maps.Animation.BOUNCE)\r\n    }\r\n  }\r\n\r\n  addListeners(marker)\r\n  return marker\r\n}\r\n\r\nfunction setupGymMarker (item) {\r\n  var marker = new google.maps.Marker({\r\n    position: {\r\n      lat: item['latitude'],\r\n      lng: item['longitude']\r\n    },\r\n    map: map,\r\n    icon: 'static/forts/' + gymTypes[item['team_id']] + '.png'\r\n  })\r\n\r\n  if (!marker.rangeCircle && isRangeActive(map)) {\r\n    marker.rangeCircle = addRangeCircle(marker, map, 'gym', item['team_id'])\r\n  }\r\n\r\n  marker.infoWindow = new google.maps.InfoWindow({\r\n    content: gymLabel(gymTypes[item['team_id']], item['team_id'], item['gym_points'], item['latitude'], item['longitude'], item['last_scanned'], item['name'], item['pokemon']),\r\n    disableAutoPan: true\r\n  })\r\n\r\n  addListeners(marker)\r\n  return marker\r\n}\r\n\r\nfunction updateGymMarker (item, marker) {\r\n  marker.setIcon('static/forts/' + gymTypes[item['team_id']] + '.png')\r\n  marker.infoWindow.setContent(gymLabel(gymTypes[item['team_id']], item['team_id'], item['gym_points'], item['latitude'], item['longitude'], item['last_scanned'], item['name'], item['pokemon']))\r\n  return marker\r\n}\r\n\r\nfunction setupPokestopMarker (item) {\r\n  var imagename = item['lure_expiration'] ? 'PstopLured' : 'Pstop'\r\n  var marker = new google.maps.Marker({\r\n    position: {\r\n      lat: item['latitude'],\r\n      lng: item['longitude']\r\n    },\r\n    map: map,\r\n    zIndex: 2,\r\n    icon: 'static/forts/' + imagename + '.png'\r\n  })\r\n\r\n  if (!marker.rangeCircle && isRangeActive(map)) {\r\n    marker.rangeCircle = addRangeCircle(marker, map, 'pokestop')\r\n  }\r\n\r\n  marker.infoWindow = new google.maps.InfoWindow({\r\n    content: pokestopLabel(item['lure_expiration'], item['latitude'], item['longitude']),\r\n    disableAutoPan: true\r\n  })\r\n\r\n  addListeners(marker)\r\n  return marker\r\n}\r\n\r\nfunction getColorByDate (value) {\r\n  // Changes the color from red to green over 15 mins\r\n  var diff = (Date.now() - value) / 1000 / 60 / 15\r\n\r\n  if (diff > 1) {\r\n    diff = 1\r\n  }\r\n\r\n  // value from 0 to 1 - Green to Red\r\n  var hue = ((1 - diff) * 120).toString(10)\r\n  return ['hsl(', hue, ',100%,50%)'].join('')\r\n}\r\n\r\nfunction setupScannedMarker (item) {\r\n  var circleCenter = new google.maps.LatLng(item['latitude'], item['longitude'])\r\n\r\n  var marker = new google.maps.Circle({\r\n    map: map,\r\n    clickable: false,\r\n    center: circleCenter,\r\n    radius: 70, // metres\r\n    fillColor: getColorByDate(item['last_modified']),\r\n    fillOpacity: 0.1,\r\n    strokeWeight: 1,\r\n    strokeOpacity: 0.5\r\n  })\r\n\r\n  return marker\r\n}\r\n\r\nfunction setupSpawnpointMarker (item) {\r\n  var circleCenter = new google.maps.LatLng(item['latitude'], item['longitude'])\r\n\r\n  var marker = new google.maps.Circle({\r\n    map: map,\r\n    clickable: false,\r\n    center: circleCenter,\r\n    radius: 5, // metres\r\n    fillColor: 'blue',\r\n    strokeWeight: 1\r\n  })\r\n\r\n  return marker\r\n}\r\n\r\nfunction clearSelection () {\r\n  if (document.selection) {\r\n    document.selection.empty()\r\n  } else if (window.getSelection) {\r\n    window.getSelection().removeAllRanges()\r\n  }\r\n}\r\n\r\nfunction addListeners (marker) {\r\n  marker.addListener('click', function () {\r\n    marker.infoWindow.open(map, marker)\r\n    clearSelection()\r\n    updateLabelDiffTime()\r\n    marker.persist = true\r\n  })\r\n\r\n  google.maps.event.addListener(marker.infoWindow, 'closeclick', function () {\r\n    marker.persist = null\r\n  })\r\n\r\n  marker.addListener('mouseover', function () {\r\n    marker.infoWindow.open(map, marker)\r\n    clearSelection()\r\n    updateLabelDiffTime()\r\n  })\r\n\r\n  marker.addListener('mouseout', function () {\r\n    if (!marker.persist) {\r\n      marker.infoWindow.close()\r\n    }\r\n  })\r\n\r\n  return marker\r\n}\r\n\r\nfunction clearStaleMarkers () {\r\n  $.each(mapData.pokemons, function (key, value) {\r\n    if (mapData.pokemons[key]['disappear_time'] < new Date().getTime() ||\r\n      excludedPokemon.indexOf(mapData.pokemons[key]['pokemon_id']) >= 0) {\r\n      if (mapData.pokemons[key].marker.rangeCircle) {\r\n        mapData.pokemons[key].marker.rangeCircle.setMap(null)\r\n        delete mapData.pokemons[key].marker.rangeCircle\r\n      }\r\n      mapData.pokemons[key].marker.setMap(null)\r\n      delete mapData.pokemons[key]\r\n    }\r\n  })\r\n\r\n  $.each(mapData.lurePokemons, function (key, value) {\r\n    if (mapData.lurePokemons[key]['lure_expiration'] < new Date().getTime() ||\r\n      excludedPokemon.indexOf(mapData.lurePokemons[key]['pokemon_id']) >= 0) {\r\n      mapData.lurePokemons[key].marker.setMap(null)\r\n      delete mapData.lurePokemons[key]\r\n    }\r\n  })\r\n\r\n  $.each(mapData.scanned, function (key, value) {\r\n    // If older than 15mins remove\r\n    if (mapData.scanned[key]['last_modified'] < (new Date().getTime() - 15 * 60 * 1000)) {\r\n      mapData.scanned[key].marker.setMap(null)\r\n      delete mapData.scanned[key]\r\n    }\r\n  })\r\n}\r\n\r\nfunction showInBoundsMarkers (markers, type) {\r\n  $.each(markers, function (key, value) {\r\n    var marker = markers[key].marker\r\n    var show = false\r\n    if (!markers[key].hidden) {\r\n      if (typeof marker.getBounds === 'function') {\r\n        if (map.getBounds().intersects(marker.getBounds())) {\r\n          show = true\r\n        }\r\n      } else if (typeof marker.getPosition === 'function') {\r\n        if (map.getBounds().contains(marker.getPosition())) {\r\n          show = true\r\n        }\r\n      }\r\n    }\r\n    // marker has an associated range\r\n    if (show && rangeMarkers.indexOf(type) !== -1) {\r\n      // no range circle yet...let's create one\r\n      if (!marker.rangeCircle) {\r\n        // but only if range is active\r\n        if (isRangeActive(map)) {\r\n          if (type === 'gym') marker.rangeCircle = addRangeCircle(marker, map, type, markers[key].team_id)\r\n          else marker.rangeCircle = addRangeCircle(marker, map, type)\r\n        }\r\n      } else { // there's already a range circle\r\n        if (isRangeActive(map)) {\r\n          marker.rangeCircle.setMap(map)\r\n        } else {\r\n          marker.rangeCircle.setMap(null)\r\n        }\r\n      }\r\n    }\r\n\r\n    if (show && !marker.getMap()) {\r\n      marker.setMap(map)\r\n      // Not all markers can be animated (ex: scan locations)\r\n      if (marker.setAnimation && marker.oldAnimation) {\r\n        marker.setAnimation(marker.oldAnimation)\r\n      }\r\n    } else if (!show && marker.getMap()) {\r\n      // Not all markers can be animated (ex: scan locations)\r\n      if (marker.getAnimation) {\r\n        marker.oldAnimation = marker.getAnimation()\r\n      }\r\n      if (marker.rangeCircle) marker.rangeCircle.setMap(null)\r\n      marker.setMap(null)\r\n    }\r\n  })\r\n}\r\n\r\nfunction loadRawData () {\r\n  var loadPokemon = Store.get('showPokemon')\r\n  var loadGyms = Store.get('showGyms')\r\n  var loadPokestops = Store.get('showPokestops')\r\n  var loadScanned = Store.get('showScanned')\r\n  var loadSpawnpoints = Store.get('showSpawnpoints')\r\n\r\n  var bounds = map.getBounds()\r\n  var swPoint = bounds.getSouthWest()\r\n  var nePoint = bounds.getNorthEast()\r\n  var swLat = swPoint.lat()\r\n  var swLng = swPoint.lng()\r\n  var neLat = nePoint.lat()\r\n  var neLng = nePoint.lng()\r\n\r\n  return $.ajax({\r\n    url: 'raw_data',\r\n    type: 'GET',\r\n    data: {\r\n      'pokemon': loadPokemon,\r\n      'pokestops': loadPokestops,\r\n      'gyms': loadGyms,\r\n      'scanned': loadScanned,\r\n      'spawnpoints': loadSpawnpoints,\r\n      'swLat': swLat,\r\n      'swLng': swLng,\r\n      'neLat': neLat,\r\n      'neLng': neLng\r\n    },\r\n    dataType: 'json',\r\n    cache: false,\r\n    beforeSend: function () {\r\n      if (rawDataIsLoading) {\r\n        return false\r\n      } else {\r\n        rawDataIsLoading = true\r\n      }\r\n    },\r\n    complete: function () {\r\n      rawDataIsLoading = false\r\n    }\r\n  })\r\n}\r\n\r\nfunction processPokemons (i, item) {\r\n  if (!Store.get('showPokemon')) {\r\n    return false // in case the checkbox was unchecked in the meantime.\r\n  }\r\n\r\n  if (!(item['encounter_id'] in mapData.pokemons) &&\r\n    excludedPokemon.indexOf(item['pokemon_id']) < 0) {\r\n    // add marker to map and item to dict\r\n    if (item.marker) {\r\n      item.marker.setMap(null)\r\n    }\r\n    if (!item.hidden) {\r\n      item.marker = setupPokemonMarker(item)\r\n      mapData.pokemons[item['encounter_id']] = item\r\n    }\r\n  }\r\n}\r\n\r\nfunction processPokestops (i, item) {\r\n  if (!Store.get('showPokestops')) {\r\n    return false\r\n  }\r\n\r\n  if (Store.get('showLuredPokestopsOnly') && !item['lure_expiration']) {\r\n    if (mapData.pokestops[item['pokestop_id']] && mapData.pokestops[item['pokestop_id']].marker) {\r\n      if (mapData.pokestops[item['pokestop_id']].marker.rangeCircle) {\r\n        mapData.pokestops[item['pokestop_id']].marker.rangeCircle.setMap(null)\r\n      }\r\n      mapData.pokestops[item['pokestop_id']].marker.setMap(null)\r\n      delete mapData.pokestops[item['pokestop_id']]\r\n    }\r\n    return true\r\n  }\r\n\r\n  if (!mapData.pokestops[item['pokestop_id']]) { // add marker to map and item to dict\r\n    // add marker to map and item to dict\r\n    if (item.marker && item.marker.rangeCircle) {\r\n      item.marker.rangeCircle.setMap(null)\r\n    }\r\n    if (item.marker) {\r\n      item.marker.setMap(null)\r\n    }\r\n    item.marker = setupPokestopMarker(item)\r\n    mapData.pokestops[item['pokestop_id']] = item\r\n  } else {\r\n    var item2 = mapData.pokestops[item['pokestop_id']]\r\n    if (!!item['lure_expiration'] !== !!item2['lure_expiration']) {\r\n      if (item2.marker && item2.marker.rangeCircle) {\r\n        item2.marker.rangeCircle.setMap(null)\r\n      }\r\n      item2.marker.setMap(null)\r\n      item.marker = setupPokestopMarker(item)\r\n      mapData.pokestops[item['pokestop_id']] = item\r\n    }\r\n  }\r\n}\r\n\r\nfunction processGyms (i, item) {\r\n  if (!Store.get('showGyms')) {\r\n    return false // in case the checkbox was unchecked in the meantime.\r\n  }\r\n\r\n  if (item['gym_id'] in mapData.gyms) {\r\n    item.marker = updateGymMarker(item, mapData.gyms[item['gym_id']].marker)\r\n  } else { // add marker to map and item to dict\r\n    item.marker = setupGymMarker(item)\r\n  }\r\n  mapData.gyms[item['gym_id']] = item\r\n}\r\n\r\nfunction processScanned (i, item) {\r\n  if (!Store.get('showScanned')) {\r\n    return false\r\n  }\r\n\r\n  var scanId = item['latitude'] + '|' + item['longitude']\r\n\r\n  if (scanId in mapData.scanned) {\r\n    mapData.scanned[scanId].marker.setOptions({\r\n      fillColor: getColorByDate(item['last_modified'])\r\n    })\r\n  } else { // add marker to map and item to dict\r\n    if (item.marker) {\r\n      item.marker.setMap(null)\r\n    }\r\n    item.marker = setupScannedMarker(item)\r\n    mapData.scanned[scanId] = item\r\n  }\r\n}\r\n\r\nfunction processSpawnpoints (i, item) {\r\n  if (!Store.get('showSpawnpoints')) {\r\n    return false\r\n  }\r\n\r\n  var id = item['spawnpoint_id']\r\n\r\n  if (id in mapData.spawnpoints) {\r\n    // In the future: maybe show how long till spawnpoint activates?\r\n  } else { // add marker to map and item to dict\r\n    if (item.marker) {\r\n      item.marker.setMap(null)\r\n    }\r\n    item.marker = setupSpawnpointMarker(item)\r\n    mapData.spawnpoints[id] = item\r\n  }\r\n}\r\n\r\nfunction updateMap () {\r\n  loadRawData().done(function (result) {\r\n    $.each(result.pokemons, processPokemons)\r\n    $.each(result.pokestops, processPokestops)\r\n    $.each(result.gyms, processGyms)\r\n    $.each(result.scanned, processScanned)\r\n    $.each(result.spawnpoints, processSpawnpoints)\r\n    showInBoundsMarkers(mapData.pokemons, 'pokemon')\r\n    showInBoundsMarkers(mapData.lurePokemons, 'pokemon')\r\n    showInBoundsMarkers(mapData.gyms, 'gym')\r\n    showInBoundsMarkers(mapData.pokestops, 'pokestop')\r\n    showInBoundsMarkers(mapData.scanned, 'scanned')\r\n    showInBoundsMarkers(mapData.spawnpoints, 'inbound')\r\n    clearStaleMarkers()\r\n    if ($('#stats').hasClass('visible')) {\r\n      countMarkers()\r\n    }\r\n  })\r\n}\r\n\r\nfunction redrawPokemon (pokemonList) {\r\n  var skipNotification = true\r\n  $.each(pokemonList, function (key, value) {\r\n    var item = pokemonList[key]\r\n    if (!item.hidden) {\r\n      if (item.marker.rangeCircle) item.marker.rangeCircle.setMap(null)\r\n      var newMarker = setupPokemonMarker(item, skipNotification, this.marker.animationDisabled)\r\n      item.marker.setMap(null)\r\n      pokemonList[key].marker = newMarker\r\n    }\r\n  })\r\n}\r\n\r\nvar updateLabelDiffTime = function () {\r\n  $('.label-countdown').each(function (index, element) {\r\n    var disappearsAt = new Date(parseInt(element.getAttribute('disappears-at')))\r\n    var now = new Date()\r\n\r\n    var difference = Math.abs(disappearsAt - now)\r\n    var hours = Math.floor(difference / 36e5)\r\n    var minutes = Math.floor((difference - (hours * 36e5)) / 6e4)\r\n    var seconds = Math.floor((difference - (hours * 36e5) - (minutes * 6e4)) / 1e3)\r\n    var timestring = ''\r\n\r\n    if (disappearsAt < now) {\r\n      timestring = '(expired)'\r\n    } else {\r\n      timestring = '('\r\n      if (hours > 0) {\r\n        timestring = hours + 'h'\r\n      }\r\n\r\n      timestring += ('0' + minutes).slice(-2) + 'm'\r\n      timestring += ('0' + seconds).slice(-2) + 's'\r\n      timestring += ')'\r\n    }\r\n\r\n    $(element).text(timestring)\r\n  })\r\n}\r\n\r\nfunction getPointDistance (pointA, pointB) {\r\n  return google.maps.geometry.spherical.computeDistanceBetween(pointA, pointB)\r\n}\r\n\r\nfunction sendNotification (title, text, icon, lat, lng) {\r\n  if (!('Notification' in window)) {\r\n    return false // Notifications are not present in browser\r\n  }\r\n\r\n  if (Notification.permission !== 'granted') {\r\n    Notification.requestPermission()\r\n  } else {\r\n    var notification = new Notification(title, {\r\n      icon: icon,\r\n      body: text,\r\n      sound: 'sounds/ding.mp3'\r\n    })\r\n\r\n    notification.onclick = function () {\r\n      window.focus()\r\n      notification.close()\r\n\r\n      centerMap(lat, lng, 20)\r\n    }\r\n  }\r\n}\r\n\r\nfunction myLocationButton (map, marker) {\r\n  var locationContainer = document.createElement('div')\r\n\r\n  var locationButton = document.createElement('button')\r\n  locationButton.style.backgroundColor = '#fff'\r\n  locationButton.style.border = 'none'\r\n  locationButton.style.outline = 'none'\r\n  locationButton.style.width = '28px'\r\n  locationButton.style.height = '28px'\r\n  locationButton.style.borderRadius = '2px'\r\n  locationButton.style.boxShadow = '0 1px 4px rgba(0,0,0,0.3)'\r\n  locationButton.style.cursor = 'pointer'\r\n  locationButton.style.marginRight = '10px'\r\n  locationButton.style.padding = '0px'\r\n  locationButton.title = 'Your Location'\r\n  locationContainer.appendChild(locationButton)\r\n\r\n  var locationIcon = document.createElement('div')\r\n  locationIcon.style.margin = '5px'\r\n  locationIcon.style.width = '18px'\r\n  locationIcon.style.height = '18px'\r\n  locationIcon.style.backgroundImage = 'url(static/mylocation-sprite-1x.png)'\r\n  locationIcon.style.backgroundSize = '180px 18px'\r\n  locationIcon.style.backgroundPosition = '0px 0px'\r\n  locationIcon.style.backgroundRepeat = 'no-repeat'\r\n  locationIcon.id = 'current-location'\r\n  locationButton.appendChild(locationIcon)\r\n\r\n  locationButton.addEventListener('click', function () {\r\n    centerMapOnLocation()\r\n  })\r\n\r\n  locationContainer.index = 1\r\n  map.controls[google.maps.ControlPosition.RIGHT_BOTTOM].push(locationContainer)\r\n}\r\n\r\nfunction centerMapOnLocation () {\r\n  var currentLocation = document.getElementById('current-location')\r\n  var imgX = '0'\r\n  var animationInterval = setInterval(function () {\r\n    if (imgX === '-18') {\r\n      imgX = '0'\r\n    } else {\r\n      imgX = '-18'\r\n    }\r\n    currentLocation.style.backgroundPosition = imgX + 'px 0'\r\n  }, 500)\r\n  if (navigator.geolocation) {\r\n    navigator.geolocation.getCurrentPosition(function (position) {\r\n      var latlng = new google.maps.LatLng(position.coords.latitude, position.coords.longitude)\r\n      locationMarker.setVisible(true)\r\n      locationMarker.setOptions({\r\n        'opacity': 1\r\n      })\r\n      locationMarker.setPosition(latlng)\r\n      map.setCenter(latlng)\r\n      clearInterval(animationInterval)\r\n      currentLocation.style.backgroundPosition = '-144px 0px'\r\n    })\r\n  } else {\r\n    clearInterval(animationInterval)\r\n    currentLocation.style.backgroundPosition = '0px 0px'\r\n  }\r\n}\r\n\r\nfunction addMyLocationButton () {\r\n  locationMarker = new google.maps.Marker({\r\n    map: map,\r\n    animation: google.maps.Animation.DROP,\r\n    position: {\r\n      lat: centerLat,\r\n      lng: centerLng\r\n    },\r\n    icon: {\r\n      path: google.maps.SymbolPath.CIRCLE,\r\n      fillOpacity: 1,\r\n      fillColor: '#1c8af6',\r\n      scale: 6,\r\n      strokeColor: '#1c8af6',\r\n      strokeWeight: 8,\r\n      strokeOpacity: 0.3\r\n    }\r\n  })\r\n  locationMarker.setVisible(false)\r\n\r\n  myLocationButton(map, locationMarker)\r\n\r\n  google.maps.event.addListener(map, 'dragend', function () {\r\n    var currentLocation = document.getElementById('current-location')\r\n    currentLocation.style.backgroundPosition = '0px 0px'\r\n    locationMarker.setOptions({\r\n      'opacity': 0.5\r\n    })\r\n  })\r\n}\r\n\r\nfunction changeLocation (lat, lng) {\r\n  var loc = new google.maps.LatLng(lat, lng)\r\n  changeSearchLocation(lat, lng).done(function () {\r\n    map.setCenter(loc)\r\n    searchMarker.setPosition(loc)\r\n    if (searchMarker.rangeCircle) searchMarker.rangeCircle.setCenter(loc)\r\n  })\r\n}\r\n\r\nfunction changeSearchLocation (lat, lng) {\r\n  return $.post('next_loc?lat=' + lat + '&lon=' + lng, {})\r\n}\r\n\r\nfunction centerMap (lat, lng, zoom) {\r\n  var loc = new google.maps.LatLng(lat, lng)\r\n\r\n  map.setCenter(loc)\r\n\r\n  if (zoom) {\r\n    storeZoom = false\r\n    map.setZoom(zoom)\r\n  }\r\n}\r\n\r\nfunction i8ln (word) {\r\n  if ($.isEmptyObject(i8lnDictionary) && language !== 'en' && languageLookups < languageLookupThreshold) {\r\n    $.ajax({\r\n      url: 'static/dist/locales/' + language + '.min.json',\r\n      dataType: 'json',\r\n      async: false,\r\n      success: function (data) {\r\n        i8lnDictionary = data\r\n      },\r\n      error: function (jqXHR, status, error) {\r\n        console.log('Error loading i8ln dictionary: ' + error)\r\n        languageLookups++\r\n      }\r\n    })\r\n  }\r\n  if (word in i8lnDictionary) {\r\n    return i8lnDictionary[word]\r\n  } else {\r\n    // Word doesn't exist in dictionary return it as is\r\n    return word\r\n  }\r\n}\r\n\r\nfunction isTouchDevice () {\r\n  // Should cover most browsers\r\n  return 'ontouchstart' in window || navigator.maxTouchPoints\r\n}\r\n\r\n//\r\n// Page Ready Exection\r\n//\r\n\r\n$(function () {\r\n  if (!Notification) {\r\n    console.log('could not load notifications')\r\n    return\r\n  }\r\n\r\n  if (Notification.permission !== 'granted') {\r\n    Notification.requestPermission()\r\n  }\r\n})\r\n\r\n$(function () {\r\n  // populate Navbar Style menu\r\n  $selectStyle = $('#map-style')\r\n\r\n  // Load Stylenames, translate entries, and populate lists\r\n  $.getJSON('static/dist/data/mapstyle.min.json').done(function (data) {\r\n    var styleList = []\r\n\r\n    $.each(data, function (key, value) {\r\n      styleList.push({\r\n        id: key,\r\n        text: i8ln(value)\r\n      })\r\n    })\r\n\r\n    // setup the stylelist\r\n    $selectStyle.select2({\r\n      placeholder: 'Select Style',\r\n      data: styleList,\r\n      minimumResultsForSearch: Infinity\r\n    })\r\n\r\n    // setup the list change behavior\r\n    $selectStyle.on('change', function (e) {\r\n      selectedStyle = $selectStyle.val()\r\n      map.setMapTypeId(selectedStyle)\r\n      Store.set('map_style', selectedStyle)\r\n    })\r\n\r\n    // recall saved mapstyle\r\n    $selectStyle.val(Store.get('map_style')).trigger('change')\r\n  })\r\n\r\n  $selectIconResolution = $('#pokemon-icons')\r\n\r\n  $selectIconResolution.select2({\r\n    placeholder: 'Select Icon Resolution',\r\n    minimumResultsForSearch: Infinity\r\n  })\r\n\r\n  $selectIconResolution.on('change', function () {\r\n    Store.set('pokemonIcons', this.value)\r\n    redrawPokemon(mapData.pokemons)\r\n    redrawPokemon(mapData.lurePokemons)\r\n  })\r\n\r\n  $selectIconSize = $('#pokemon-icon-size')\r\n\r\n  $selectIconSize.select2({\r\n    placeholder: 'Select Icon Size',\r\n    minimumResultsForSearch: Infinity\r\n  })\r\n\r\n  $selectIconSize.on('change', function () {\r\n    Store.set('iconSizeModifier', this.value)\r\n    redrawPokemon(mapData.pokemons)\r\n    redrawPokemon(mapData.lurePokemons)\r\n  })\r\n\r\n  $selectLuredPokestopsOnly = $('#lured-pokestops-only-switch')\r\n\r\n  $selectLuredPokestopsOnly.select2({\r\n    placeholder: 'Only Show Lured Pokestops',\r\n    minimumResultsForSearch: Infinity\r\n  })\r\n\r\n  $selectLuredPokestopsOnly.on('change', function () {\r\n    Store.set('showLuredPokestopsOnly', this.value)\r\n    updateMap()\r\n  })\r\n\r\n  $selectSearchIconMarker = $('#iconmarker-style')\r\n\r\n  $.getJSON('static/dist/data/searchmarkerstyle.min.json').done(function (data) {\r\n    searchMarkerStyles = data\r\n    var searchMarkerStyleList = []\r\n\r\n    $.each(data, function (key, value) {\r\n      searchMarkerStyleList.push({\r\n        id: key,\r\n        text: value.name\r\n      })\r\n    })\r\n\r\n    $selectSearchIconMarker.select2({\r\n      placeholder: 'Select Icon Marker',\r\n      data: searchMarkerStyleList,\r\n      minimumResultsForSearch: Infinity\r\n    })\r\n\r\n    $selectSearchIconMarker.on('change', function (e) {\r\n      var selectSearchIconMarker = $selectSearchIconMarker.val()\r\n      Store.set('searchMarkerStyle', selectSearchIconMarker)\r\n      updateSearchMarker(selectSearchIconMarker)\r\n    })\r\n\r\n    $selectSearchIconMarker.val(Store.get('searchMarkerStyle')).trigger('change')\r\n\r\n    updateSearchMarker(Store.get('lockMarker'))\r\n  })\r\n})\r\n\r\n$(function () {\r\n  function formatState (state) {\r\n    if (!state.id) {\r\n      return state.text\r\n    }\r\n    var $state = $(\r\n      '<span><i class=\"pokemon-sprite n' + state.element.value.toString() + '\"></i> ' + state.text + '</span>'\r\n    )\r\n    return $state\r\n  }\r\n\r\n  if (Store.get('startAtUserLocation')) {\r\n    centerMapOnLocation()\r\n  }\r\n\r\n  $selectExclude = $('#exclude-pokemon')\r\n  $selectPokemonNotify = $('#notify-pokemon')\r\n  $selectRarityNotify = $('#notify-rarity')\r\n  var numberOfPokemon = 151\r\n\r\n  // Load pokemon names and populate lists\r\n  $.getJSON('static/dist/data/pokemon.min.json').done(function (data) {\r\n    var pokeList = []\r\n\r\n    $.each(data, function (key, value) {\r\n      if (key > numberOfPokemon) {\r\n        return false\r\n      }\r\n      var _types = []\r\n      pokeList.push({\r\n        id: key,\r\n        text: i8ln(value['name']) + ' - #' + key\r\n      })\r\n      value['name'] = i8ln(value['name'])\r\n      value['rarity'] = i8ln(value['rarity'])\r\n      $.each(value['types'], function (key, pokemonType) {\r\n        _types.push({\r\n          'type': i8ln(pokemonType['type']),\r\n          'color': pokemonType['color']\r\n        })\r\n      })\r\n      value['types'] = _types\r\n      idToPokemon[key] = value\r\n    })\r\n\r\n    // setup the filter lists\r\n    $selectExclude.select2({\r\n      placeholder: i8ln('Select Pokmon'),\r\n      data: pokeList,\r\n      templateResult: formatState\r\n    })\r\n    $selectPokemonNotify.select2({\r\n      placeholder: i8ln('Select Pokmon'),\r\n      data: pokeList,\r\n      templateResult: formatState\r\n    })\r\n    $selectRarityNotify.select2({\r\n      placeholder: i8ln('Select Rarity'),\r\n      data: [i8ln('Common'), i8ln('Uncommon'), i8ln('Rare'), i8ln('Very Rare'), i8ln('Ultra Rare')],\r\n      templateResult: formatState\r\n    })\r\n\r\n    // setup list change behavior now that we have the list to work from\r\n    $selectExclude.on('change', function (e) {\r\n      excludedPokemon = $selectExclude.val().map(Number)\r\n      clearStaleMarkers()\r\n      Store.set('remember_select_exclude', excludedPokemon)\r\n    })\r\n    $selectPokemonNotify.on('change', function (e) {\r\n      notifiedPokemon = $selectPokemonNotify.val().map(Number)\r\n      Store.set('remember_select_notify', notifiedPokemon)\r\n    })\r\n    $selectRarityNotify.on('change', function (e) {\r\n      notifiedRarity = $selectRarityNotify.val().map(String)\r\n      Store.set('remember_select_rarity_notify', notifiedRarity)\r\n    })\r\n\r\n    // recall saved lists\r\n    $selectExclude.val(Store.get('remember_select_exclude')).trigger('change')\r\n    $selectPokemonNotify.val(Store.get('remember_select_notify')).trigger('change')\r\n    $selectRarityNotify.val(Store.get('remember_select_rarity_notify')).trigger('change')\r\n  })\r\n\r\n  // run interval timers to regularly update map and timediffs\r\n  window.setInterval(updateLabelDiffTime, 1000)\r\n  window.setInterval(updateMap, 5000)\r\n  window.setInterval(function () {\r\n    if (navigator.geolocation && Store.get('geoLocate')) {\r\n      navigator.geolocation.getCurrentPosition(function (position) {\r\n        var baseURL = location.protocol + '//' + location.hostname + (location.port ? ':' + location.port : '')\r\n        var lat = position.coords.latitude\r\n        var lon = position.coords.longitude\r\n\r\n        // the search function makes any small movements cause a loop. Need to increase resolution\r\n        if (getPointDistance(searchMarker.getPosition(), (new google.maps.LatLng(lat, lon))) > 40) {\r\n          $.post(baseURL + '/next_loc?lat=' + lat + '&lon=' + lon).done(function () {\r\n            var center = new google.maps.LatLng(lat, lon)\r\n            map.panTo(center)\r\n            searchMarker.setPosition(center)\r\n          })\r\n        }\r\n      })\r\n    }\r\n  }, 1000)\r\n\r\n  // Wipe off/restore map icons when switches are toggled\r\n  function buildSwitchChangeListener (data, dataType, storageKey) {\r\n    return function () {\r\n      Store.set(storageKey, this.checked)\r\n      if (this.checked) {\r\n        updateMap()\r\n      } else {\r\n        $.each(dataType, function (d, dType) {\r\n          $.each(data[dType], function (key, value) {\r\n            // for any marker you're turning off, you'll want to wipe off the range\r\n            if (data[dType][key].marker.rangeCircle) {\r\n              data[dType][key].marker.rangeCircle.setMap(null)\r\n              delete data[dType][key].marker.rangeCircle\r\n            }\r\n            if (storageKey !== 'showRanges') data[dType][key].marker.setMap(null)\r\n          })\r\n          if (storageKey !== 'showRanges') data[dType] = {}\r\n        })\r\n        if (storageKey === 'showRanges') {\r\n          updateMap()\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  // Setup UI element interactions\r\n  $('#gyms-switch').change(buildSwitchChangeListener(mapData, ['gyms'], 'showGyms'))\r\n  $('#pokemon-switch').change(buildSwitchChangeListener(mapData, ['pokemons'], 'showPokemon'))\r\n  $('#scanned-switch').change(buildSwitchChangeListener(mapData, ['scanned'], 'showScanned'))\r\n  $('#spawnpoints-switch').change(buildSwitchChangeListener(mapData, ['spawnpoints'], 'showSpawnpoints'))\r\n  $('#ranges-switch').change(buildSwitchChangeListener(mapData, ['gyms', 'pokemons', 'pokestops'], 'showRanges'))\r\n\r\n  $('#pokestops-switch').change(function () {\r\n    var options = {\r\n      'duration': 500\r\n    }\r\n    var wrapper = $('#lured-pokestops-only-wrapper')\r\n    if (this.checked) {\r\n      wrapper.show(options)\r\n    } else {\r\n      wrapper.hide(options)\r\n    }\r\n    return buildSwitchChangeListener(mapData, ['pokestops'], 'showPokestops').bind(this)()\r\n  })\r\n\r\n  $('#sound-switch').change(function () {\r\n    Store.set('playSound', this.checked)\r\n  })\r\n\r\n  $('#geoloc-switch').change(function () {\r\n    $('#next-location').prop('disabled', this.checked)\r\n    $('#next-location').css('background-color', this.checked ? '#e0e0e0' : '#ffffff')\r\n    if (!navigator.geolocation) {\r\n      this.checked = false\r\n    } else {\r\n      Store.set('geoLocate', this.checked)\r\n    }\r\n  })\r\n\r\n  $('#lock-marker-switch').change(function () {\r\n    Store.set('lockMarker', this.checked)\r\n    searchMarker.setDraggable(!this.checked)\r\n  })\r\n\r\n  $('#search-switch').change(function () {\r\n    searchControl(this.checked ? 'on' : 'off')\r\n  })\r\n\r\n  $('#start-at-user-location-switch').change(function () {\r\n    Store.set('startAtUserLocation', this.checked)\r\n  })\r\n\r\n  if ($('#nav-accordion').length) {\r\n    $('#nav-accordion').accordion({\r\n      active: 0,\r\n      collapsible: true,\r\n      heightStyle: 'content'\r\n    })\r\n  }\r\n})\r\n"]}